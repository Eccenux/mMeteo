
// en.js, line#0

// EOC
window.mJappisApplication.i18n.en = {"":""

	,"title-application" : "Forecast"

	,"unexpected error" : "Unexpected error!"

	,"add - title" : "Add"
	,"edit - title" : "Edit"
	,"delete - title" : "Delete"

		,"button-show-map" : "Show position (mini-map)"
		,"map" : "map"

		,"could not detect your position"     : "Could not detect your position. Turn on your wireless network (WiFi) or GPS."
		,"retrieving your position timed out" : "Retrieving your position timed out. You can try again."

		,"error: position empty"           : "Error! Geo. position is empty.\n\nPlease refresh position or type in latitude and longitude yourself."
		,"error: position must be decimal" : "Error! Geo. position is incorrect. Latitude and longitude must be decimal.\n\nCorrect thoose values or try to refresh the position."

		,"title-um-model" : "Short forecast"
		,"title-coamps-model" : "Long forecast"
		,"label-latitude"  : "Latitude (N)"
		,"label-longitude" : "Longitude (E)"

	,"label-settings-language"         : "Language"
	,"label-settings-language-pl"      : "Polski"
	,"label-settings-language-en"      : "English"
		,"label-settings-getPositionType"                  : "Position acquiry"
		,"label-settings-getPositionType-automatic"        : "Automatic (at startup)"
		,"label-settings-getPositionType-manual-only"      : "Manual (refresh for automatic)"
		,"label-settings-getPositionType-manual-but-saved" : "Manual with saving previous"
	,"group-settings-mainNavi" : "Navigation buttons"
	,"label-settings-mainNaviFormat"            : "Format"
	,"label-settings-mainNaviFormat-icons&text" : "Icons & text"
	,"label-settings-mainNaviFormat-icons-only" : "Icons only"
	,"label-settings-mainNaviFormat-text-only"  : "Text only"
	,"label-settings-mainNaviPosition"               : "Position"
	,"label-settings-mainNaviPosition-bottom-fixed"  : "Fixed to the bottom"
	,"label-settings-mainNaviPosition-below-content" : "Below content"
	,"label-settings-mainNaviPosition-below-header"  : "Below header"
	,"group-settings-advanced" : "Advanced"
	,"label-settings-pageTransitions"           : "Animation type for transitions"
	,"label-settings-pageTransitions-none"      : "None (best performance)"
	,"label-settings-pageTransitions-slide"     : "Slide"
	,"label-settings-pageTransitions-slideup"   : "Slide up"
	,"label-settings-pageTransitions-slidedown" : "Slide down"
	,"label-settings-pageTransitions-pop"       : "Pop"
	,"label-settings-pageTransitions-fade"      : "Fade"
	,"label-settings-pageTransitions-flip"      : "Flip"
	,"label-settings-pageTransitions-turn"      : "Turn"
	,"label-settings-pageTransitions-flow"      : "Flow"
	,"label-settings-pageTransitions-slidefade" : "Slide-fade"

		,"button-refresh" : "Refresh position"

	,"form-invalid" : "Please correct the form"
	,"submit"       : "Save"

	,"validator-messages" :
	{
		required: "This field is required.",
		remote: "Please fix this field.",
		email: "Please enter a valid email address.",
		url: "Please enter a valid URL.",
		date: "Please enter a valid date.",
		dateISO: "Please enter a valid date (ISO).",
		number: "Please enter a valid number.",
		digits: "Please enter only digits.",
		creditcard: "Please enter a valid credit card number.",
		equalTo: "Please enter the same value again.",
		accept: "Please enter a value with a valid extension.",
		maxlength: jQuery.validator.format("Please enter no more than {0} characters."),
		minlength: jQuery.validator.format("Please enter at least {0} characters."),
		rangelength: jQuery.validator.format("Please enter a value between {0} and {1} characters long."),
		range: jQuery.validator.format("Please enter a value between {0} and {1}."),
		max: jQuery.validator.format("Please enter a value less than or equal to {0}."),
		min: jQuery.validator.format("Please enter a value greater than or equal to {0}.")
	}
};
// en.js, EOF
// pl.js, line#0

// EOC
window.mJappisApplication.i18n.pl = {"":""

	,"title-application" : "Prognoza"
	,"Back" : "Powrót"
	,"Edit" : "Edytuj"
	,"Save" : "Zapisz"
	,"Cancel" : "Anuluj"
	,"Columns..." : "Kolumny..."
	,"Share URL" : "Podziel się linkiem"


	,"unexpected error" : "Niespodziewany błąd!"

	,"add - title" : "Dodaj"
	,"edit - title" : "Edytuj"
	,"delete - title" : "Usuń"

		,"could not detect your position"     : "Nie udało się wykryć położenia. Włącz sieć bezprzewodową (WiFi) lub odbiornik GPS."
		,"retrieving your position timed out" : "Nie udało się wykryć położenia w rozsądnym czasie. Spróbuj jeszcze raz."

		,"button-show-map" : "Pokaż położenie (mini-mapa)"
		,"map" : "mapa"

		,"error: position empty"           : "Błąd! Współrzędne położenia są puste.\n\nOdśwież położenie lub wpisz długość i szerokość ręcznie."
		,"error: position must be decimal" : "Błąd! Współrzędne położenia są nieprawidłowe. Długość i szerokość muszą być wpisane w formie liczb dziesiętnych.\n\nPopraw lub spróbuj odświeżyć położenie."

		,"title-um-model" : "Krótka prognoza"
		,"title-coamps-model" : "Długa prognoza"
		,"label-latitude"  : "Szerokość (N)"
		,"label-longitude" : "Długość (E)"

	,"label-settings-language"         : "Język"
	,"label-settings-language-pl"      : "Polski"
	,"label-settings-language-en"      : "English"
		,"label-settings-getPositionType"                  : "Pobieranie położenia"
		,"label-settings-getPositionType-automatic"        : "Od razu po uruchomieniu"
		,"label-settings-getPositionType-manual-only"      : "Ręcznie przyciskiem"
		,"label-settings-getPositionType-manual-but-saved" : "Ręcznie z automatycznym zapisem poprzedniej"
	,"group-settings-mainNavi" : "Przyciski nawigacyjne"
	,"label-settings-mainNaviFormat"            : "Format"
	,"label-settings-mainNaviFormat-icons&text" : "Ikony i tekst"
	,"label-settings-mainNaviFormat-icons-only" : "Tylko ikony"
	,"label-settings-mainNaviFormat-text-only"  : "Tylko tekst"
	,"label-settings-mainNaviPosition"               : "Pozycja"
	,"label-settings-mainNaviPosition-bottom-fixed"  : "Przytwierdzone na dole"
	,"label-settings-mainNaviPosition-below-content" : "Pod zawartością"
	,"label-settings-mainNaviPosition-below-header"  : "Pod nagłówkiem"
	,"group-settings-advanced" : "Zaawansowane"
	,"label-settings-pageTransitions"           : "Animacje przy zmianie stron"
	,"label-settings-pageTransitions-none"      : "Brak (wysoka wydajność)"
	,"label-settings-pageTransitions-slide"     : "Przesunięcie"
	,"label-settings-pageTransitions-slideup"   : "Do góry"
	,"label-settings-pageTransitions-slidedown" : "W dół"
	,"label-settings-pageTransitions-pop"       : "Wyskakujące"
	,"label-settings-pageTransitions-fade"      : "Przenikanie"
	,"label-settings-pageTransitions-flip"      : "Obrocik"
	,"label-settings-pageTransitions-turn"      : "Przewróć stronę"
	,"label-settings-pageTransitions-flow"      : "Przepływ"
	,"label-settings-pageTransitions-slidefade" : "Przesunięcie przenikane"

		,"button-refresh" : "Odśwież położenie"

	,"form-invalid" : "Proszę poprawić formularz"
	,"submit"       : "Zapisz"

	,"validator-messages" :
	{
		required: "To pole jest wymagane.",
		remote: "Proszę o wypełnienie tego pola.",
		email: "Proszę o podanie prawidłowego adresu email.",
		url: "Proszę o podanie prawidłowego URL.",
		date: "Proszę o podanie prawidłowej daty.",
		dateISO: "Proszę o podanie prawidłowej daty (ISO).",
		number: "Proszę o podanie prawidłowej liczby.",
		digits: "Proszę o podanie samych cyfr.",
		creditcard: "Proszę o podanie prawidłowej karty kredytowej.",
		equalTo: "Proszę o podanie tej samej wartości ponownie.",
		accept: "Proszę o podanie wartości z prawidłowym rozszerzeniem.",
		maxlength: jQuery.validator.format("Proszę o podanie nie więcej niż {0} znaków."),
		minlength: jQuery.validator.format("Proszę o podanie przynajmniej {0} znaków."),
		rangelength: jQuery.validator.format("Proszę o podanie wartości o długości od {0} do {1} znaków."),
		range: jQuery.validator.format("Proszę o podanie wartości z przedziału od {0} do {1}."),
		max: jQuery.validator.format("Proszę o podanie wartości mniejszej bądź równej {0}."),
		min: jQuery.validator.format("Proszę o podanie wartości większej bądź równej {0}.")
	}
};
// pl.js, EOF
// model.js, line#0

// EOC
// EOC
(function($, $mJ)
{
	$mJ.storage = $mJ.storage || {};
// EOC
	$mJ.storage.storageKey = 'mMeteoData';
// EOC
	$mJ.storage.schema =
	{
		position :
		{
			favorite :
			{
				 lat : {type:"text", value:""}
				,lon : {type:"text", value:""}
			}
		}
		,
		settings :
		{
			language        : {type:"select", value:"pl", options:["pl", "en"]}

			,mainNaviFormat  : {type:"select", value:"icons&text", options:['icons&text', 'icons-only', 'text-only']}

			,getPositionType : {type:"select", value:"manual-but-saved", options:['automatic', 'manual-only', 'manual-but-saved']}

			,skin            : {type:"select", value:"default", options:['default']}


			,pageTransitions : {type:"select", value:"none", options:['none', 'slide', 'slideup', 'slidedown', 'pop', 'fade', 'flip', 'turn', 'flow', 'slidefade']}
			// type of footer/buttons: fixed to bottom*, below content, below header; *default, but don't work too good on all phones (browsers)
			,mainNaviPosition: {type:"select", value:"bottom-fixed", options:['bottom-fixed', 'below-content', 'below-header']}
		}
	};

	function getBrowserLanguage(fallback, available) {
		var language = window.navigator.userLanguage || window.navigator.language;
		if ($.inArray(language, available) < 0) {
			return fallback;
		}
		return language;
	}
// EOC
	$mJ.storage.initialData =
	{
		settings :
		{
			 language :  getBrowserLanguage("pl", ["pl", "en"])
		}
	};
	/**/

})(jQuery, window.mJappisApplication);
// model.js, EOF
// settings.js, line#0

// EOC
// EOC
(function($, $mJ)
{
	//var LOG = new Logger('controller.settings');
// EOC
	$mJ.controller.settings = function(parameters)
	{
		var $thisForm = $('#settings-form');

		//


		var tmpFormData = $mJ.form.init('settings');


		var formData = formCreator (
		[
			$mJ.form.getElementOptions('getPositionType')
			,
			$mJ.form.getElementOptions('language')
			,
			$mJ.form.startSet()
				,
				$mJ.form.startGroup('mainNavi', {collapsed:true})
					,
					$mJ.form.getElementOptions('mainNaviFormat')
					,
					$mJ.form.getElementOptions('mainNaviPosition')
				,
				$mJ.form.endGroup()
				,
				$mJ.form.startGroup('advanced', {collapsed:true})
					,
					$mJ.form.getElementOptions('pageTransitions')
				,
				$mJ.form.endGroup()
			,
			$mJ.form.endSet()
			,
			{
				type      : 'submit'
				,name     : 'settings-submit'
				,lbl      : $mJ.i18n.get("submit")
			}
		]);
		$mJ.form.close();


		$thisForm.html(formData);


		$thisForm.trigger( "create" );


		$('#settings-submit-btn')
			.unbind()
			.click(function()
			{
				$thisForm.submit();
				return false;
			})
		;


		$thisForm.validate({meta: "validation"});

		//

		$thisForm
			.unbind()
			.submit(function(event)
			{

				if (!$mJ.form.valid(this))
				{
					return false;
				}


				$mJ.storage.set('settings', tmpFormData);


				location.href = 'index.html';

				event.preventDefault();
				return false;
			})
		;
	};

})(jQuery, window.mJappisApplication);
// settings.js, EOF
// start.js, line#0

// EOC
// EOC
(function($, $mJ)
{
	var _currentGeoSelectorPrefix = '#forecastform-';
// EOC
	var _fillGeo = function ()
	{
		$mJ.geo.initGet (function(pos)
		{
			$(_currentGeoSelectorPrefix + 'lat')
				.val(pos.coords.latitude)
				.change()
			;
			$(_currentGeoSelectorPrefix + 'lon')
				.val(pos.coords.longitude)
				.change()
			;
		});
	};
// EOC
	var _startDone = false;
// EOC
	$mJ.controller.start = function(parameters)
	{

		if (_startDone)
		{
			return;
		}
		_startDone = true;

		//

		var getPositionType = $mJ.storage.get('settings.getPositionType');
		if (getPositionType == 'automatic')
		{
			_fillGeo();
		}

		//

		if (getPositionType == 'manual-but-saved')
		{
			$mJ.bindInput(_currentGeoSelectorPrefix + 'lat', 'position.favorite.lat');
			$mJ.bindInput(_currentGeoSelectorPrefix + 'lon', 'position.favorite.lon');
		}

		//

		$('.refresh-geo').click(function()
		{
			_fillGeo();
		});

		$('#show-map-button').click(function()
		{
			$mJ.geo.loadMap($('#forecastform-lat').val(), $('#forecastform-lon').val(), '#map-preview');
		});

		//

		$('#forecastform').submit(function()
		{

			var ll = { lat: $(_currentGeoSelectorPrefix + 'lat').val(), lon: $(_currentGeoSelectorPrefix + 'lon').val() };
			ll.lat = ll.lat.replace(/,/, '.');
			ll.lon = ll.lon.replace(/,/, '.');
			$(_currentGeoSelectorPrefix + 'lat').val(ll.lat);
			$(_currentGeoSelectorPrefix + 'lon').val(ll.lon);


			var info = "";
			if (ll.lat == '' || ll.lon == '')
			{
				info = "error: position empty";
			}
			else if (ll.lat.search(/^[0-9.]+$/) < 0 || ll.lon.search(/^[0-9.]+$/) < 0)
			{
				info = "error: position must be decimal";
			}


			if (info.length)
			{
				alert($mJ.i18n.get(info));
				return false;
			}


			var modelChoosen = $('#forecastform').attr('data-model');
// EOC
			var actionUrl = $('#forecastform').attr('data-action-'+modelChoosen);
			if (actionUrl)
			{
				$('#forecastform').attr('action', actionUrl);
			}
			return true;
		});
	};

})(jQuery, window.mJappisApplication);
// start.js, EOF